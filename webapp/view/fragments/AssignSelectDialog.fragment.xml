<core:FragmentDefinition
        xmlns="sap.m"
        xmlns:table="sap.ui.table"
        xmlns:core="sap.ui.core"
        xmlns:controls="com.evorait.evoplan.ui.controls">

    <Dialog title="{i18n>xtit.assignModalTitle}"
            contentHeight="80%"
            stretch="false"
            resizable="true"
            draggable="true"
            icon="sap-icon://activity-individual"
            class="treeTableDialog"
            beforeOpen="refreshDialogTable">
        <content>
            <Toolbar>
                <SearchField id="idSeachModalTree"
                			 search="onSearchModal"
                             showRefreshButton="{= !${device>/support/touch} }"
                             width="100%" />
            </Toolbar>

            <table:TreeTable
                    id="assignModalTable"
                    selectionMode="Single"
                    enableColumnReordering="false"
                    columnHeaderVisible="false"
                    visibleRowCount="10"
                    visibleRowCountMode="Auto"
                    class="listTreeTable sapUiSizeCondensed"
                    rowSelectionChange="onSelectionChange"
                    selectionBehavior = "Row"
                    rows="{
                        		path : '/ResourceHierarchySet',
                        		parameters:{
                        			numberOfExpandedLevels:1,
                        			restoreTreeStateAfterChange:true
                        		}
                    }">

                <table:columns>
                    <table:Column
                            label="{i18n>xtit.tableObject}"
                            name="{i18n>xtit.tableObject}">
                        <table:template>
                            <controls:CustomTitle
                                    text="{Description}"
                                    titleStyle="{
                                        path: 'NodeType',
                                        formatter: '.formatter.formatResourceTitle'
                                    }"
                                    icon="{
                                         parts:[{path: 'NodeType'},{path: 'StatusIcon'}],
                                         formatter: '.formatter.getResourceIcon'
                                    }"
                                    availabilityIcon="{
                                           path: 'IS_AVAILABLE',
                                           formatter: '.formatter.getAvailabilityIcon'
                                    }"
                                    iconColor="{
                                           path: 'IS_AVAILABLE',
                                           formatter: '.formatter.formatIconColor'
                                    }"
                                    iconTooltip="{
                                           path: 'IS_AVAILABLE',
                                           formatter: '.formatter.formatIconTooltip'
                                    }"
                                    />
                        </table:template>
                    </table:Column>
                    <table:Column
                            label="{i18n>xtit.tableWorkload}"
                            name="{i18n>xtit.tableWorkload}"
                            width="7rem"
                            hAlign="End"
                            visible="{= ${/#ResourceHierarchy/Utilization/@sap:visible} === 'true'? true : false }">
                        <table:template>
                           <!-- <ProgressIndicator
                                    percentValue="{Utilization}"
                                    displayValue="{Utilization}%"
                                    showValue="true"
                                    state="None"
                                    visible="{
                                              path: 'NodeType',
                                              formatter: '.formatter.isMainResource'
                                        }"/>-->
                                        
                                <Text 
                                	text="{Utilization}H" 
                                	visible="{ path: 'NodeType', formatter: '.formatter.isMainResource' }" 
                                	wrapping="false"/>
                        </table:template>
                    </table:Column>
                    <table:Column
                            label="{i18n>xtit.tableAssignment}"
                            name="{i18n>xtit.tableAssignment}"
                            width="4rem"
                            hAlign="End">
                        <table:template>
                            <Text text="{AssignmentCount}"
                                  visible="{= ${NodeType} === 'ASSIGNMENT' ? false : true }"/>
                        </table:template>
                    </table:Column>
                </table:columns>
            </table:TreeTable>

        </content>

        <beginButton>
            <Button text="{i18n>xbut.buttonCancel}" press="onCloseDialog" />
        </beginButton>

        <endButton>
            <Button text="{i18n>xbut.buttonOK}" type="Emphasized" press="onSaveDialog" />
        </endButton>
    </Dialog>

</core:FragmentDefinition>