<mvc:View xmlns="sap.m"
		  xmlns:mvc="sap.ui.core.mvc"
		  xmlns:core="sap.ui.core"
		  xmlns:gnt2="sap.gantt.simple"
		  xmlns:def="sap.gantt.def"
		  xmlns:pattern="sap.gantt.def.pattern"
		  xmlns:table="sap.ui.table"
		  xmlns:dnd="sap.ui.core.dnd"
		  controllerName="com.evorait.evoplan.controller.Gantt"
		  displayBlock="true"
		  height="100%">
	<Page id="ganttPage" showFooter="false" showHeader="false">


		<gnt2:GanttChartContainer class="resourceGanttCont" id="container" enableTimeScrollSync="true" busy="{viewModel>/ganttSettings/busy}">
			<gnt2:toolbar showDisplayTypeButton="true">
				<gnt2:ContainerToolbar
						design="Auto"
						showBirdEyeButton="false"
						showLegendButton="true"
						class="gantt_toolbar"
						>
					<gnt2:content>
						<DateRangeSelection
								id="idDateRangeGantt2"
								width="20%"
								dateValue="{user>/GANT_START_DATE}"
								secondDateValue="{user>/GANT_END_DATE}"
								maxDate="{user>/GANT_END_DATE}"
								minDate="{user>/GANT_START_DATE}"
								change="onChangeDateRange"
								enabled="false"
						/>
						
						<core:Fragment fragmentName="com.evorait.evoplan.view.fragments.ResourceActions" type="XML"/>
						<Button id="idToday" text="{i18n>xtit.today}" press="onPressToday"/>
					</gnt2:content>
					<gnt2:legendContainer>
						<gnt2:LegendContainer width="230px" height="250px">
							<gnt2:ListLegend title="{i18n>xtit.colorCodes}" items="{/GanttLegendSet}">
								<gnt2:ListLegendItem>
									<gnt2:BaseRectangle shapeId="{CharactersticCode}" fill="{parts:[{path:'Colourcode'},
									{path:'Legendtype'}

									],
									formatter:'.formatLegend'}" title="{CharactersticDescription}" showTitle="false"/>
								</gnt2:ListLegendItem>
							</gnt2:ListLegend>
						</gnt2:LegendContainer>
					</gnt2:legendContainer>
					

				</gnt2:ContainerToolbar>
			</gnt2:toolbar>

			<gnt2:GanttChartWithTable id="ganttResourceAssignments"
									  ghostAlignment="Start"
									  adhocLineLayer="Bottom"
									  shapeSelectionMode = "Single"
									  shapeSelectionSettings="{color:'red', strokeDasharray:'1,0'}"
									  shapeDrop="onShapeDrop"
									  shapeResize="onShapeResize"
									  shapeMouseEnter="onShapeMouseEnter"
									  shapeMouseLeave="onShapeMouseLeave"
									  shapeDoubleClick="onShapeDoubleClick"
									  shapeContextMenu="onShapeContextMenu"
									  showShapeTimeOnDrag="true"
									  selectionPanelSize="25%"
									  nowLineInUTC="false">
				<gnt2:table>
					<table:TreeTable
							id="ganttResourceTreeTable"
							class="resourceGanttTreeTable"
							selectionMode="Single"
							visibleRowCountMode="Auto"
							enableColumnReordering="false"
							enableBusyIndicator="true"
							busyStateChanged="onBusyStateChanged"
							enableCellFilter="false"
							columnHeaderVisible="false"
							selectionBehavior="RowOnly"
							
							rowHeight="25"
							rows="{
							 path: '/GanttResourceHierarchySet',
							 parameters: {
								operationMode: 'Server',
								numberOfExpandedLevels: 1,
								expand: 'AssignmentSet,ResourceAvailabilitySet',
								groupId: 'GanttTree'
								}
							}">
						<table:extension>
							<OverflowToolbar>
								<content>
									<core:Fragment fragmentName="com.evorait.evoplan.view.fragments.TreeExpandCollapse" type="XML"/>
									<SearchField search="onSearchResource"/>
							     </content>
								
							</OverflowToolbar>
						</table:extension>
						<table:rowSettingsTemplate>
							<gnt2:GanttRowSettings rowId="{NodeId}"
								shapes3="{
									path:'AssignmentSet',
									templateShareable:true
								}"
								shapes2="{
										path:'ResourceAvailabilitySet',
										templateShareable:true
								}">

								<gnt2:shapes1>
									<core:Fragment fragmentName="com.evorait.evoplan.view.gantt.BackGroundShape" type="XML"/>
								</gnt2:shapes1>

								<gnt2:shapes2>
									<core:Fragment fragmentName="com.evorait.evoplan.view.gantt.UnAvailabilityShape" type="XML"/>
								</gnt2:shapes2>

								<gnt2:shapes3>
									<core:Fragment fragmentName="com.evorait.evoplan.view.gantt.AssignmentShape" type="XML"/>
								</gnt2:shapes3>


							</gnt2:GanttRowSettings>
						</table:rowSettingsTemplate>

						<core:Fragment fragmentName="com.evorait.evoplan.view.gantt.ResourceTreeColumns" type="XML"/>
						<table:dragDropConfig>
							<dnd:DropInfo
								targetAggregation="rows"
								dropPosition="On"
								drop="onDropOnResource" />
						</table:dragDropConfig>
						<table:columns>
								<table:Column label="{i18n>xtit.tableCheckbox}" name="{i18n>xtit.tableCheckbox}" width="2.5rem" class="sapUiNoContentPadding">
							<table:customData>
								<core:CustomData key="p13nData" value='\{"columnKey": "NodeType", "leadingProperty": "NodeType"}'/>
							</table:customData>
							<table:template>
								<CheckBox enabled="true" select="onChangeSelectResource" visible="{ path: 'NodeType', formatter: '.formatter.isMainResource' }"
									selected="{IsSelected}"/>
							</table:template>
						</table:Column>
						</table:columns>
					</table:TreeTable>
				</gnt2:table>

				<gnt2:axisTimeStrategy>
					<core:Fragment fragmentName="com.evorait.evoplan.view.gantt.AxisTimeStrategy" type="XML"/>
				</gnt2:axisTimeStrategy>

				<gnt2:svgDefs>
					<def:SvgDefs>
						<def:defs>
							<pattern:SlashPattern id="unavailability" backgroundColor="white" stroke="#ccc"></pattern:SlashPattern>
						</def:defs>
					</def:SvgDefs>
				</gnt2:svgDefs>

			</gnt2:GanttChartWithTable>

		</gnt2:GanttChartContainer>

	</Page>
</mvc:View>